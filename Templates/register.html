<html>
<head>
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>

<body style='background-color:Silver; align:center, width:200; border: 10px solid Teal;'>
    <div>
        <center><h3>Welcome To Automobile Site</h3></center>
        <center><h5><i><u>All about new cars in India under one roof</u></i></h5 ></center>
        <div class="container" style='background-color:Silver;'>
        <center><h2>User Registration Form</h2><center>
        <div class="container">
            {% if messages %} {% for i in messages %}
            <div class="alert alert-{{i.tags}}">
                <h6> {{i}} </h6>
            </div>
            {% endfor %} {% endif %}
        </div>
        <div class="mydiv-tablealign" style='align:center, width:200; border: 10px solid Teal;'>
        <center><form enctype='multipart/form-data' method="Post">
            {% csrf_token %}
            <table>
                <td>
                    <table>
                        <td>
                            <tr>
                                <td><br>First Name : </td>
                                <td><br><input type='text' name='fname' placeholder='First Name'></td>
                            </tr>
                            <tr>
                                <td><br>Last Name : </td>
                                <td><br><input type='text' name='lname' placeholder='Last Name'></td>
                            </tr>
                            <tr>
                                <td><br>Email : </td>
                                <td><br><input type='email' name='email' placeholder='Email'></td>
                            </tr>
                            <tr>
                                <td><br>Username : </td>
                                <td><br><input type='username' name='username' id='username' placeholder='Username' onkeyup="check_user()" ></td>
                            </tr>
                            <tr>
                                <td><br>Password : </td>
                                <td><br><input type='password' name='password1' placeholder='Password'></td>
                            </tr>
                            <tr>
                                <td><br>Confirm Password : </td>
                                <td><br><input type='password' name='password2' placeholder='Confirm Password'></td>
                            </tr>
                            <tr>
                                <td><br><input type="submit" class='btn btn-success' value="Register" class="form-control"></td>
                            </tr>
                        </td>
                    </table>
                    <td style='text-align:center'><img src="/static/usericon.png" width='200' ,height="100"></td>
                </td>
            </table>
        </form><center>
    </div>
    <center><div style='align:center, width:200; border: 10px solid Teal;'>
        <a href="/" class='btn btn-info'>Back To Login</a>
    </div></center>
</div>
</body>

<script>
    function check_user(){
        let un = document.getElementById("username").value;
        $.ajax({
            url:"{% url 'check_user' %}",
            type:"get",
            data:{username:un},
            success:function(data){
                if(data=="Exists"){
                    $("#result").html("This username already taken").addClass("text-danger");
                    $("#username").addClass("alert alert-danger");
                    $("#submitbtn").attr("disabled","disabled");
                }else{
                    $("#result").html("");
                    $("#username").removeClass("alert alert-danger")
                    $("#submitbtn").removeAttr("disabled");
                }
            }
        })
        
    }
    
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
</script>

</html>